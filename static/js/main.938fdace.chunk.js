(this["webpackJsonpdocsvision-test"]=this["webpackJsonpdocsvision-test"]||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),c=n(47),i=n.n(c),o=n(120),u=n(22),s="SET_PLACES_TREE",d="SET_INVENTORIES",l="SET_PLACES_LOADING",f="SET_PLACES_LOADING_ERROR",j="SET_INVENTORIES_LOADING",p="SET_PLACES_LOADING_ERROR",b="SET_CURRENT_PLACE_ID";function O(e,t,n,r){if(!e.findBFS(n.id)){e.add(n.id,n.name,r);var a=n.id;n.parts&&n.parts.length>0&&n.parts.forEach((function(n){var r=t.findIndex((function(e){return e.id===n})),c=t[r];O(e,t,c,a)}))}}var h=n(29),v=n(81),x=n(68),y=function e(t,n){Object(x.a)(this,e),this.id=void 0,this.name=void 0,this.parts=void 0,this.id=t,this.name=n,this.parts=[]},g=function(){function e(){Object(x.a)(this,e),this.root=void 0,this.root={id:"buildings",name:"\u0412\u0441\u0435 \u0437\u0434\u0430\u043d\u0438\u044f",parts:[]}}return Object(v.a)(e,[{key:"add",value:function(e,t,n){var r=new y(e,t),a=n?this.findBFS(n):this.findBFS("buildings");a&&a.parts.push(r)}},{key:"findBFS",value:function(e){this.root;var t=null;return this.traverseBFS((function(n){n.id===e&&(t=n)})),t}},{key:"traverseBFS",value:function(e){var t=[this.root];if(e)for(;t.length;){var n=t[0];t.shift(),e(n);var r,a=Object(h.a)(n.parts);try{for(a.s();!(r=a.n()).done;){var c=r.value;t.push(c)}}catch(i){a.e(i)}finally{a.f()}}}}]),e}(),m=n(38),I=n.n(m),E=n(50),S=n(65);S.a.initializeApp({apiKey:"AIzaSyD6DnGbVfdJlDJ_pEOUfDfTDJrA8j3lIs8",authDomain:"dv-inventory.firebaseapp.com",databaseURL:"https://dv-inventory.firebaseio.com",projectId:"dv-inventory",storageBucket:"dv-inventory.appspot.com",messagingSenderId:"130062240176",appId:"1:130062240176:web:ecbca5d29b37d25c6cee75"});var L=function(){var e=Object(E.a)(I.a.mark((function e(){var t,n,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=S.a.firestore(),e.next=3,t.collection("places").get();case 3:return n=e.sent,r=n.docs.map((function(e){return{id:e.id,name:e.data().name,parts:e.data().parts&&e.data().parts.map((function(e){return e.id}))}})),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function _(e){return e.filter((function(e){return void 0!==e.id&&void 0!==e.name&&void 0!==e.count&&void 0!==e.placeId}))}var T=function(){var e=Object(E.a)(I.a.mark((function e(){var t,n,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=S.a.firestore(),e.next=3,t.collection("inventory").get();case 3:return n=e.sent,r=n.docs.map((function(e){return{id:e.id&&e.id,name:e.data&&e.data().name,count:e.data&&e.data().count,placeId:e.data&&e.data().place&&e.data().place.id}})),e.abrupt("return",_(r));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(e){return{type:l,payload:e}},R=function(e){return{type:f,payload:e}},A=function(e){return{type:j,payload:e}},w=function(e){return{type:f,payload:e}},D=function(){return function(e){e(P(!0)),e(R(!1)),L().then((function(t){e(function(e){for(var t=new g,n=0;n<e.length;n++)O(t,e,e[n]);return{type:s,payload:t.root}}(t)),e(P(!1))})).catch((function(){return e(R(!0))}))}},k=function(){return function(e){e(A(!0)),e(w(!1)),T().then((function(t){e(function(e){return{type:d,payload:e}}(t)),e(A(!1))})).catch((function(){return e(w(!0))}))}},C=function(e){return{type:b,payload:e}},N=n(116),B=n(117),F=n(6),G=function(e){var t=e.left,n=e.right;return Object(F.jsxs)(N.a,{flex:"auto",children:[Object(F.jsx)(B.a,{flex:"30%",minW:"300px",bg:"green.50",children:t}),Object(F.jsx)(B.a,{flex:"70%",bg:"blue.50",children:n})]})},J=function(e){var t=e.left,n=e.right;return Object(F.jsxs)(N.a,{minH:"100vh",flexDirection:"column",justifyContent:"space-between",children:[Object(F.jsx)(U,{}),Object(F.jsx)(G,{left:t,right:n}),Object(F.jsx)(V,{})]})},U=function(){return Object(F.jsx)(B.a,{h:"50px",bg:"gray.200",children:"Header"})},V=function(){return Object(F.jsx)(B.a,{h:"50px",bg:"gray.200",children:"Footer"})},z=n(121),H=function(){return Object(F.jsx)(N.a,{h:"200px",alignItems:"center",justifyContent:"center",children:Object(F.jsx)(z.a,{})})},M=n(119),K=function(){var e=Object(u.c)((function(e){return e.placeReducer})),t=e.placesTree,n=e.isPlacesLoading;e.isPlacesLoadingError,e.currentPlaceId;return n?Object(F.jsx)(H,{}):Object(F.jsx)(M.a,{defaultIndex:[0],allowMultiple:!0,children:t&&W(t)})};function W(e){return e.parts.length>0?Object(F.jsx)(q,{placeId:e.id,title:e.name,children:e.parts.map((function(e){return W(e)}))},e.id):Object(F.jsx)(Q,{id:e.id,name:e.name},e.id)}var q=function(e){var t=e.placeId,n=e.title,r=e.children,a=Object(u.b)();return Object(F.jsxs)(M.d,{placeid:t,pr:"0",children:[n&&Object(F.jsx)("h2",{children:Object(F.jsxs)(M.b,{onClick:function(){a(C(t))},children:[Object(F.jsx)(B.a,{flex:"1",textAlign:"left",p:"0",pl:"5px",children:n}),Object(F.jsx)(M.c,{})]})}),Object(F.jsx)(M.e,{pr:"0",children:r})]})},Q=function(e){var t=e.id,n=e.name,r=Object(u.b)();return Object(F.jsx)(B.a,{onClick:function(){r(C(t))},flex:"1",m:"10px",textAlign:"left",p:"0",pl:"5px",children:n})},X=n(8),Y=n(118),Z=n(122),$=function(e){var t=e.name,n=e.count;return Object(F.jsxs)(Y.a,{children:["\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435: ",t,", \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e: ",n,",",Object(F.jsx)(Z.a,{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(F.jsx)(Z.a,{children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})};function ee(e,t){var n=[],r=function(e,t){var n=null;return te(t,(function(t){t.id===e&&(n=t)})),n}(e,t);return te(r||t,(function(e){n.push(e.id)})),n}function te(e,t){if(null!==e){var n=[e];if(t)for(;n.length;){var r=n[0];n.shift(),t(r);var a,c=Object(h.a)(r.parts);try{for(c.s();!(a=c.n()).done;){var i=a.value;n.push(i)}}catch(o){c.e(o)}finally{c.f()}}}}var ne=function(){var e=Object(r.useState)([]),t=Object(X.a)(e,2),n=t[0],a=t[1],c=Object(u.c)((function(e){return e.placeReducer})),i=c.inventories,o=c.currentPlaceId,s=c.placesTree,d=c.isInventoriesLoading;Object(r.useEffect)((function(){var e=ee(o,s);a(e)}),[o]);var l=i.filter((function(e){return"buildings"===o||n.includes(e.placeId)}));return d?Object(F.jsx)(H,{}):Object(F.jsx)(Y.b,{children:l.map((function(e){return Object(F.jsx)($,{name:e.name,count:e.count},e.id)}))})},re=function(){var e=Object(u.b)();return Object(r.useEffect)((function(){e(D()),e(k())}),[]),Object(F.jsx)(J,{left:Object(F.jsx)(K,{}),right:Object(F.jsx)(ne,{})})};var ae=function(){return Object(F.jsx)(re,{})},ce=n(31),ie=n(83),oe=n(20),ue={currentPlaceId:"buildings",placesTree:null,isPlacesLoading:!1,isPlacesLoadingError:!1,inventories:[],isInventoriesLoading:!1,isInventoriesLoadingError:!1},se=Object(ce.c)({placeReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s:return Object(oe.a)(Object(oe.a)({},e),{},{placesTree:t.payload});case l:return Object(oe.a)(Object(oe.a)({},e),{},{isPlacesLoading:t.payload});case f:return Object(oe.a)(Object(oe.a)({},e),{},{isPlacesLoadingError:t.payload});case d:return Object(oe.a)(Object(oe.a)({},e),{},{inventories:t.payload});case j:return Object(oe.a)(Object(oe.a)({},e),{},{isInventoriesLoading:t.payload});case p:return Object(oe.a)(Object(oe.a)({},e),{},{isInventoriesLoadingError:t.payload});case b:return Object(oe.a)(Object(oe.a)({},e),{},{currentPlaceId:t.payload});default:return e}}}),de=Object(ce.e)(se,Object(ce.d)(Object(ce.a)(ie.a)));i.a.render(Object(F.jsx)(a.a.StrictMode,{children:Object(F.jsx)(u.a,{store:de,children:Object(F.jsx)(o.a,{children:Object(F.jsx)(ae,{})})})}),document.getElementById("root"))}},[[105,1,2]]]);
//# sourceMappingURL=main.938fdace.chunk.js.map